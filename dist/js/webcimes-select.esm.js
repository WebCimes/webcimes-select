var e={d:(t,s)=>{for(var o in s)e.o(s,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:s[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{D:()=>s});class s{select;webcimesSelect;webcimesSelectDropDown=null;options;getHtmlElements=e=>{let t=[];return e instanceof NodeList&&(t=[...Array.from(e)]),e instanceof HTMLElement&&(t=[e]),"string"==typeof e&&(t=[...Array.from(document.querySelectorAll(e))]),t};getHtmlElement=e=>{let t=null;return e instanceof HTMLElement&&(t=e),"string"==typeof e&&(t=document.querySelector(e)),t};setSelectedValue(){this.select&&(""!==this.select.value?(this.webcimesSelect.classList.remove("placeholder"),this.webcimesSelect.querySelector(".text").innerHTML=this.select.value,this.webcimesSelect.querySelector(".clear")?.classList.add("active")):this.options.placeholder&&(this.webcimesSelect.classList.add("placeholder"),this.webcimesSelect.querySelector(".text").innerHTML=this.options.placeholder,this.webcimesSelect.querySelector(".clear")?.classList.remove("active")))}setDropDownOptions(e){this.webcimesSelectDropDown.querySelectorAll(".option").forEach((e=>{e.removeEventListener("click",this.eventSelectOptionDropDown)}));let t=document.createElement("template");e.forEach(((e,s)=>{let o=document.createElement("template");if(o.innerHTML=`<div class="option ${0==s?"highlighted":""} ${e.classList.toString()}" data-value="${e.value}">${e.innerHTML}</div>\n`,e.closest("optgroup")){let s=e.closest("optgroup").label;if(!t.content.querySelector(`.optGroup[data-label='${s}']`)){let e=document.createElement("template");e.innerHTML=`<div class="optGroup" data-label="${s}">\n\t\t\t\t\t\t<div class="label">${s}</div>\n\t\t\t\t\t</div>\n`,t.content.appendChild(e.content)}t.content.querySelector(`.optGroup[data-label='${s}']`)?.appendChild(o.content)}else t.content.appendChild(o.content)})),this.webcimesSelectDropDown.querySelector(".options").replaceChildren(t.content),this.webcimesSelectDropDown.querySelectorAll(".option").forEach((e=>{e.addEventListener("click",this.eventSelectOptionDropDown)}))}setDropDownPositionAndWidth(e=!1){if(this.webcimesSelectDropDown){let t=this.webcimesSelect.getBoundingClientRect();e&&this.webcimesSelect.classList.contains("directionTop")||!e&&t.bottom+this.webcimesSelectDropDown.getBoundingClientRect().height>window.innerHeight?(this.webcimesSelect.classList.remove("directionBottom"),this.webcimesSelect.classList.add("directionTop"),this.webcimesSelectDropDown.classList.remove("directionBottom"),this.webcimesSelectDropDown.classList.add("directionTop"),this.webcimesSelectDropDown.style.top=t.top-this.webcimesSelectDropDown.getBoundingClientRect().height+window.scrollY+"px"):(this.webcimesSelect.classList.remove("directionTop"),this.webcimesSelect.classList.add("directionBottom"),this.webcimesSelectDropDown.classList.remove("directionTop"),this.webcimesSelectDropDown.classList.add("directionBottom"),this.webcimesSelectDropDown.style.top=t.bottom+window.scrollY+"px"),this.webcimesSelectDropDown.style.left=t.left+window.scrollX+"px",this.webcimesSelectDropDown.style.width=t.width+"px"}}destroyDropDown(){this.webcimesSelectDropDown&&(this.webcimesSelect.classList.remove("open"),this.webcimesSelect.focus(),this.webcimesSelectDropDown.querySelector("input[name='search']").removeEventListener("input",this.eventSearchDropDown),document.removeEventListener("keydown",this.eventKeyboardControlsDropDown),window.removeEventListener("resize",this.eventResizeDropDown),document.addEventListener("click",this.eventDestroyDropDown),this.webcimesSelectDropDown.querySelectorAll(".option").forEach((e=>{e.removeEventListener("click",this.eventSelectOptionDropDown)})),this.webcimesSelectDropDown.remove(),this.webcimesSelectDropDown=null)}eventSearchDropDown=e=>{let t=new RegExp(e.target.value,"i"),s=Array.from(this.select.options).filter((e=>{if(""!==e.value&&(t.test(e.innerHTML)||t.test(e.value)))return e}));if(0==s.length&&this.options.searchTextNoResults){let e=document.createElement("option");e.classList.add("noResults"),e.innerHTML=this.options.searchTextNoResults,s.push(e)}this.setDropDownOptions(s),this.setDropDownPositionAndWidth(!0)};eventKeyboardControlsDropDown=e=>{if(e.target!=this.webcimesSelect){let t=this.webcimesSelectDropDown.querySelector(".option.highlighted");if(t){let s=this.webcimesSelectDropDown.querySelectorAll(".option"),o=Array.from(s).indexOf(t);"ArrowUp"!=e.key&&"ArrowDown"!=e.key||(t.classList.remove("highlighted"),t=s["ArrowUp"==e.key?o-1>=0?o-1:0:o+1<=s.length-1?o+1:s.length-1],t.classList.add("highlighted"),t.scrollIntoView({behavior:"smooth",block:"nearest"})),"Enter"==e.key&&(t.classList.remove("highlighted"),this.select.value=t.getAttribute("data-value"),this.setSelectedValue(),this.destroyDropDown()),"Escape"==e.key&&this.destroyDropDown()}}};eventResizeDropDown=()=>{this.setDropDownPositionAndWidth()};eventSelectOptionDropDown=e=>{this.select.value=e.target.getAttribute("data-value"),this.setSelectedValue()};eventDestroyDropDown=e=>{e.target.closest(".webcimesSelect")==this.webcimesSelect||e.target.closest(".webcimesSelectDropDown input[name='search']")||this.destroyDropDown()};constructor(e){this.options={element:null,setId:null,setClass:null,width:"auto",height:"auto",maxHeightOptions:"200px",style:null,placeholder:null,allowClear:!0,allowSearch:!0,searchAutoFocus:!0,searchPlaceholder:"Search",searchTextNoResults:"No results found",beforeShow:()=>{},afterShow:()=>{},beforeDestroy:()=>{},afterDestroy:()=>{},...e},this.init()}init(){this.select=this.getHtmlElement(this.options.element),this.select&&(this.select.style.display="none",this.select.insertAdjacentHTML("afterend",`<div class="webcimesSelect ${this.options.setClass?this.options.setClass:""}" ${this.options.setId?`id="${this.options.setId}"`:""} tabindex="0">\n\t\t\t\t\t<div class="text"></div>\n\t\t\t\t\t${this.options.allowClear?'<div class="clear"><div class="cross"></div></div>':""}\n\t\t\t\t</div>`),this.webcimesSelect=this.select.nextElementSibling,this.options.placeholder||this.select.querySelector("option[value='']")&&(this.options.placeholder=this.select.querySelector("option[value='']").innerHTML),this.setSelectedValue(),this.webcimesSelect.querySelector(".clear")?.addEventListener("click",(e=>{this.select.value="",this.setSelectedValue(),this.destroyDropDown()})),this.webcimesSelect?.addEventListener("keydown",(e=>{" "!=e.key&&"Enter"!=e.key&&"ArrowUp"!=e.key&&"ArrowDown"!=e.key||(e.preventDefault(),this.webcimesSelect.dispatchEvent(new Event("click")))})),this.webcimesSelect.addEventListener("click",(e=>{if(this.webcimesSelectDropDown||e.target.closest(".clear"))this.destroyDropDown();else{this.webcimesSelect.classList.add("open"),document.body.insertAdjacentHTML("beforeend",`<div class="webcimesSelectDropDown">\n\t\t\t\t\t\t\t${this.options.allowSearch?`<div class="search"><input type="text" name="search" autocomplete="off" ${this.options.searchPlaceholder?`placeholder="${this.options.searchPlaceholder}"`:""}></div>`:""}\n\t\t\t\t\t\t\t<div class="options" style="max-height:${this.options.maxHeightOptions};"></div>\n\t\t\t\t\t\t</div>`),this.webcimesSelectDropDown=document.body.lastElementChild;let e=Array.from(this.select.options).filter((e=>{if(""!==e.value)return e}));if(this.setDropDownOptions(Array.from(e)),this.setDropDownPositionAndWidth(),this.options.allowSearch){let e=this.webcimesSelectDropDown.querySelector("input[name='search']");this.options.searchAutoFocus&&e.focus(),e.addEventListener("input",this.eventSearchDropDown)}document.addEventListener("keydown",this.eventKeyboardControlsDropDown),window.addEventListener("resize",this.eventResizeDropDown),document.addEventListener("click",this.eventDestroyDropDown)}})))}destroy(){}}var o=t.D;export{o as WebcimesSelect};
//# sourceMappingURL=webcimes-select.esm.js.map